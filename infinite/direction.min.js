/*
 infinite(direction).js (c) 2015 Seun Ogedengbe, MIT*/
infinite=function(f,l,v,a){a=a||{};var k={parent:null,offset:0,loading:{lines:a.lines||16,rate:a.rate||1E3/30,diameter:a.diameter||250,back:a.loaderback||"#FFF",color:a.color||"#373737"},config:{dir:a.dir||"assets/",pagestartnum:!1,chapterstartnum:!1,imgprebuffer:a.imgprebuffer||5,imgpostbuffer:a.imgpostbuffer||5,startpage:0,back:a.back||"#FFF"},pages:[]};if(void 0===f)return-1;if("string"===typeof f)k.pages.push({alt:"",hover:"",title:"",url:[f],release:0,note:"",perm:!1,anim8:!1}),f=k;else if(Array.isArray(f)){for(a=
0;a<f.length;a++)if(k.pages.push({alt:"",hover:"",title:"",url:[],release:0,note:"",perm:!1,anim8:!1}),Array.isArray(f[a]))for(var x=0;x<f[a].length;x++)k.pages[a].url.push(f[a][x]);else k.pages[a].url.push(f[a]);f=k}else if(void 0===f.pages[0].url)return-1;if(void 0===l||null==l)l=0;var g=f.pages,h=f.pages.length,m=-1,n=f.loading,p=f.config,t=[],u=[],c=[],y=!1,e=[document.createElement("canvas"),document.createElement("canvas")],q=e[1].getContext("2d"),z=a=function(){return 0},w=a,A=a,B={context:e[0].getContext("2d"),
color:n.color,start:Date.now(),lines:n.lines,diameter:n.diameter,rate:n.rate},D=function(b){e[0].style.paddingLeft=(e[1].width-300)/2+"px";var a=Math.floor((Date.now()-b.start)/1E3*b.lines)/b.lines,d=b.color.substr(1);b.context.save();b.context.clearRect(0,0,300,e[1].height);b.context.translate(150,e[1].height/2);b.context.rotate(2*Math.PI*a);3==d.length&&(d=d[0]+C[0]+d[1]+d[1]+d[2]+d[2]);for(var a=parseInt(d.substr(0,2),16).toString(),f=parseInt(d.substr(2,2),16).toString(),d=parseInt(d.substr(4,
2),16).toString(),c=0;c<b.lines;c++)b.context.beginPath(),b.context.rotate(2*Math.PI/b.lines),b.context.moveTo(b.diameter/10,0),b.context.lineTo(b.diameter/4,0),b.context.lineWidth=b.diameter/30,b.context.strokeStyle="rgba("+a+","+f+","+d+","+c/b.lines+")",b.context.stroke();b.context.restore();window.setTimeout(D,b.rate,B)},E=function(b,a,d){q.clearRect(0,0,e[1].width,e[1].height);var c=a.x,f=a.y;b&&q.drawImage(b,c-b.height,f,e[1].width,b.height);a&&q.drawImage(a,c,f,e[1].width,a.height);d&&q.drawImage(d,
c+a.height,f,e[1].width,d.height)},F=function(b,a){return{x:void 0!==window.pageXOffset?b.x-window.pageXOffset:b.x-document.documentElement.scrollLeft,y:void 0!==window.pageYOffset?b.y-window.pageYOffset:b.y-document.documentElement.scrollTop}},k=function(){g[this.imaginaryID].loaded=!0},G=[function(){if(0>this.imaginaryID||this.imaginaryID>=h||void 0===this.imaginaryID||void 0===this.src)return 0;g[this.imaginaryID].loaded?q.clearRect(0,0,e[1].width,e[1].height):g[this.imaginaryID].loaded=!0;E(0<=
c[0].imaginaryID?c[0]:0,this,0<=c[2].imaginaryID?c[2]:0)},function(){if(0>this.imaginaryID||this.imaginaryID>=h||void 0===this.imaginaryID||void 0===this.src)return 0;g[this.imaginaryID].loaded?q.clearRect(0,0,e[1].width,e[1].height):g[this.imaginaryID].loaded=!0;w();E(0<=c[0].imaginaryID?c[0]:0,this,0<=c[2].imaginaryID?c[2]:0);y&&F();A()},function(){G[0]()}],r=function(b,a){window.setTimeout(D,n.rate,B);z();0>a&&(a=0);a>=h&&(a=h-1);g[a].loaded||q.clearRect(0,0,e[1].width,e[1].height);for(var d=0;3>
d;d++)b[d].imaginaryID=a-1+d,a-1+d<h&&0<=a-1+d?b[d].src=p.dir+g[a-1+d].url[0]:(b[d].imaginaryID=-1,b[d].src="");m=a;for(var d=0,c=a-1;c>a-p.imgprebuffer-1&&0<=c;c--)g[c].loaded||(u[d].imaginaryID=c,u[d].src=p.dir+g[c].url,d++);d=0;for(c=a+1;c<p.imgpostbuffer+a+1&&c<h;c++)g[c].loaded||(t[d].imaginaryID=c,t[d].src=p.dir+g[c].url,d++)};this.count=function(){return h};this.current=function(){return m};this.callback=function(b,a){if(null===b||void 0===b)return w;if(null===a||void 0===a)return b?0<b?A:
z:w;b?0<b?A=a:z=a:w=a;return 1};this.go=function(a){a=null===a||void 0===a?0:parseInt(a,10);a=isNaN(a)?0:a;r(master,Math.floor(Math.max(0,Math.min(h-1,a))));return a};this.prev=function(){var a=m-1;0<=a&&r(master,a);return a};this.next=function(){var a=m+1;a<h&&r(master,a);return a};this.frst=function(){0<=m&&r(master,0);return 0};this.last=function(){r(master,h-1);return h-1};this.rand=function(){var a=Math.floor(Math.random()*(h-1));r(master,a);return a};this.data=function(a){a=null===a||void 0===
a?m:parseInt(a,10);return isNaN(a)?g[m]:g[a]};this.scroll=function(a){return null===a||void 0===a?y:y=a};this.scrollTo=function(a,c){return F(a,c)};e[0].height=480;e[0].style.background=n.back;e[0].style.paddingLeft="170px";e[0].style.zIndex=0;e[0].style.position="absolute";l?l.appendChild(e[0]):document.body.appendChild(e[0]);window.setTimeout(D,n.rate,B);for(a=0;3>a;a++)c.push(new Image),c[a].imaginaryID=-1,c[a].x=0,c[a].y=0,c[a].addEventListener("load",G[a],!1);for(a=0;a<g.length;a++)g[a].desig=
a?a==g.length-1?1:0:-1,g[a].loaded=!1;for(a=0;a<f.config.imgprebuffer;a++)u.push(new Image),u[a].imaginaryID=-1,u[a].addEventListener("load",k,!1);for(a=0;a<f.config.imgpostbuffer;a++)t.push(new Image),t[a].imaginaryID=-1,t[a].addEventListener("load",k,!1);window.onresize=function(){e[1].height=.7*(window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight);e[1].width=.7*(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth);E(0<=c[0].imaginaryID?
c[0]:0,this,0<=c[2].imaginaryID?c[2]:0)};r(c,void 0===v||null===v||isNaN(v)?p.startpage:v);e[1].height=.7*(window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight);e[1].width=.7*(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth);e[1].background=p.back;e[1].style.zIndex=1;e[1].style.position="relative";l?l.appendChild(e[1]):document.body.appendChild(e[1]);this.canvi=e;this.internals=f};
